diff -U 0 -rpN a/Source/ccib.f90 b/Source/ccib.f90
--- a/Source/ccib.f90	2024-02-19 16:35:24.935137600 +0900
+++ b/Source/ccib.f90	2024-02-19 17:10:29.982464100 +0900
@@ -6045 +6045 @@ CHARACTER(200)::TCFORM
-INTEGER :: N,IERR,NOM,SNODE
+INTEGER :: N,IERR,NOM,SNODE,N_SIZE
@@ -6260 +6260,3 @@ IF(CC_STRESS_METHOD) THEN
-         IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+         !IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+         CALL MPI_COMM_SIZE(MPI_COMM_NEIGHBORS(NM),N_SIZE,IERR)
+         IF (N_SIZE == 0) CYCLE
@@ -20198 +20200 @@ INTEGER, ALLOCATABLE, DIMENSION(:) :: NC
-INTEGER :: ISTR,IEND,JSTR,JEND,KSTR,KEND,IIO,JJO,KKO,IOR,IW,N_INT
+INTEGER :: ISTR,IEND,JSTR,JEND,KSTR,KEND,IIO,JJO,KKO,IOR,IW,N_INT,N_SIZE
@@ -20475 +20477,3 @@ IF (N_MPI_PROCESSES>1) THEN
-      IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+      !IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+      CALL MPI_COMM_SIZE(MPI_COMM_NEIGHBORS(NM),N_SIZE,IERR)
+      IF (N_SIZE == 0) CYCLE
diff -U 0 -rpN a/Source/main.f90 b/Source/main.f90
--- a/Source/main.f90	2024-02-19 16:35:25.247122300 +0900
+++ b/Source/main.f90	2024-02-19 17:12:31.396497300 +0900
@@ -1747,0 +1748 @@ SUBROUTINE EXCHANGE_GEOMETRY_INFO
+INTEGER :: N_SIZE
@@ -1752 +1753,3 @@ DO NM=1,NMESHES
-   IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+   !IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+   CALL MPI_COMM_SIZE(MPI_COMM_NEIGHBORS(NM),N_SIZE,IERR)
+   IF (N_SIZE == 0) CYCLE
@@ -2254,0 +2258 @@ INTEGER :: N_OVERLAP,IW,II,JJ,KK,IIG,JJG
+INTEGER :: N_SIZE
@@ -2268 +2272,3 @@ DO WHILE (ANY(SETUP_PRESSURE_ZONES_INDEX
-         IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+         !IF (MPI_COMM_NEIGHBORS(NM)==MPI_COMM_NULL) CYCLE
+         CALL MPI_COMM_SIZE(MPI_COMM_NEIGHBORS(NM),N_SIZE,IERR)
+         IF (N_SIZE == 0) CYCLE
