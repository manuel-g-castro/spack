      SUBROUTINE SETPRD(N1,NGAUSS,NC,PSIC,NN,PSI,W,IUT0,IERR)
      IMPLICIT NONE

***** PARAMETERS *****
      INTEGER N1
      
***** DEFINE ARGUMENTS *****
      INTEGER NGAUSS
      REAL*8 NC(N1)
      REAL*8 PSIC(3,N1)
      REAL*8 NN(N1,NGAUSS)
      REAL*8 PSI(3,N1,NGAUSS)
      REAL*8 W(NGAUSS)
      
***** OBJECTS *****
      REAL*8 XI(3,NGAUSS)
      REAL*8 P(99),Q(99),R(99)
      REAL*8 S(99),T(99),U(99)
      INTEGER IUT0,IERR      
      INTEGER MX, MY, MZ, I, J, K !
      INTEGER IP                !

****************************
***** N, PSI AT CENTER *****
****************************
      XI(1,1)=0.; XI(2,1)=0.; XI(3,1)=0.25
      NC(1) =0.25*( (1.-XI(1,1))*(1.-XI(2,1))
     $     -XI(3,1) +XI(1,1)*XI(2,1)*XI(3,1)/(1.-XI(3,1)) )
      NC(2) =0.25*( (1.+XI(1,1))*(1.-XI(2,1))
     $     -XI(3,1) -XI(1,1)*XI(2,1)*XI(3,1)/(1.-XI(3,1)) )
      NC(3) =0.25*( (1.+XI(1,1))*(1.+XI(2,1))
     $     -XI(3,1) +XI(1,1)*XI(2,1)*XI(3,1)/(1.-XI(3,1)) )
      NC(4) =0.25*( (1.-XI(1,1))*(1.+XI(2,1))
     $     -XI(3,1) -XI(1,1)*XI(2,1)*XI(3,1)/(1.-XI(3,1)) )
      NC(5) = XI(3,1)

      PSIC(1,1)=0.25*( -1. +XI(2,1)/(1.-XI(3,1)) )
      PSIC(1,2)=0.25*( +1. -XI(2,1)/(1.-XI(3,1)) )
      PSIC(1,3)=0.25*( +1. +XI(2,1)/(1.-XI(3,1)) )
      PSIC(1,4)=0.25*( -1. -XI(2,1)/(1.-XI(3,1)) )
      PSIC(1,5)=0.
      
      PSIC(2,1)=0.25*( -1. +XI(1,1)/(1.-XI(3,1)) )
      PSIC(2,2)=0.25*( -1. -XI(1,1)/(1.-XI(3,1)) )
      PSIC(2,3)=0.25*( +1. +XI(1,1)/(1.-XI(3,1)) )
      PSIC(2,4)=0.25*( +1. -XI(1,1)/(1.-XI(3,1)) )
      PSIC(2,5)=0.
      
      PSIC(3,1)=0.25*( -1. +XI(1,1)*XI(2,1)/(1.-XI(3,1))**2 )
      PSIC(3,2)=0.25*( -1. -XI(1,1)*XI(2,1)/(1.-XI(3,1))**2 )
      PSIC(3,3)=0.25*( -1. +XI(1,1)*XI(2,1)/(1.-XI(3,1))**2 )
      PSIC(3,4)=0.25*( -1. -XI(1,1)*XI(2,1)/(1.-XI(3,1))**2 )
      PSIC(3,5)=1.

      
      IF(NGAUSS.EQ.4) THEN        !4X1
         MX=2
         P(1)=-SQRT(1./3.); S(1)=1.
         P(2)=+SQRT(1./3.); S(2)=1.
         MY=2
         Q(1)=-SQRT(1./3.); T(1)=1.
         Q(2)=+SQRT(1./3.); T(2)=1.
         MZ=1
         R(1)=0.25;         U(1)=1./3.
         
      ELSEIF(NGAUSS.EQ.18) THEN   !9X2
      MX=3
      P(1)=-SQRT(3./5.);      S(1)=5./9.
      P(2)=0.;                S(2)=8./9.
      P(3)=+SQRT(3./5.);      S(3)=5./9.
      MY=3
      Q(1)=-SQRT(3./5.);      T(1)=5./9.
      Q(2)=0.;                T(2)=8./9.
      Q(3)=+SQRT(3./5.);      T(3)=5./9.
      MZ=2
      R(1)=0.122514822655441; U(1)=0.232547451253508
      R(2)=0.544151844011225; U(2)=0.100785882079825
      
      ELSEIF(NGAUSS.EQ.27) THEN   ! 9X3
         MX=3
         P(1)=-SQRT(3./5.);      S(1)=5./9.
         P(2)=0.;                S(2)=8./9.
         P(3)=+SQRT(3./5.);      S(3)=5./9.
         MY=3
         Q(1)=-SQRT(3./5.);      T(1)=5./9.
         Q(2)=0.;                T(2)=8./9.
         Q(3)=+SQRT(3./5.);      T(3)=5./9.
         MZ=3
         R(1)= 0.072994024073150; U(1)=0.157136361064887
         R(2)= 0.347003766038352; U(2)=0.146246269259866
         R(3)= 0.705002209888498; U(3)=0.029950703008581
         
      ELSEIF(NGAUSS.EQ.48) THEN   ! 16X3
         MX=4
         P(1)=-0.861136311594053; S(1)=0.347854845137454
         P(2)=-0.339981043584856; S(2)=0.652145154862546
         P(3)=+0.339981043584856; S(3)=0.652145154862546
         P(4)=+0.861136311594053; S(4)=0.347854845137454
         MY=4
         Q(1)=-0.861136311594053; T(1)=0.347854845137454
         Q(2)=-0.339981043584856; T(2)=0.652145154862546
         Q(3)=+0.339981043584856; T(3)=0.652145154862546
         Q(4)=+0.861136311594053; T(4)=0.347854845137454
         MZ=3
         R(1)= 0.072994024073150; U(1)=0.157136361064887
         R(2)= 0.347003766038352; U(2)=0.146246269259866
         R(3)= 0.705002209888498; U(3)=0.029950703008581
         
      ELSEIF(NGAUSS.EQ.64) THEN   ! 16X4
         MX=4
         P(1)=-0.861136311594053; S(1)=0.347854845137454
         P(2)=-0.339981043584856; S(2)=0.652145154862546
         P(3)=+0.339981043584856; S(3)=0.652145154862546
         P(4)=+0.861136311594053; S(4)=0.347854845137454
         MY=4
         Q(1)=-0.861136311594053; T(1)=0.347854845137454
         Q(2)=-0.339981043584856; T(2)=0.652145154862546
         Q(3)=+0.339981043584856; T(3)=0.652145154862546
         Q(4)=+0.861136311594053; T(4)=0.347854845137454
         MZ=4
         R(1)= 0.048500549446997; U(1)=0.110888415611278
         R(2)= 0.238600737551862; U(2)=0.143458789799214
         R(3)= 0.517047295104368; U(3)=0.068633887172923
         R(4)= 0.795851417896773; U(4)=0.010352240749918
         
      ELSEIF(NGAUSS.EQ.75) THEN   ! 25X3
         MX=5
         P(1)=-0.906179845938664; S(1)=0.236926885056189
         P(2)=-0.538469310105683; S(2)=0.478628670499366
         P(3)=0.;                 S(3)=0.568888888888889
         P(4)=+0.538469310105683; S(4)=0.478628670499366
         P(5)=+0.906179845938664; S(5)=0.236926885056189
         MY=5
         Q(1)=-0.906179845938664; T(1)=0.236926885056189
         Q(2)=-0.538469310105683; T(2)=0.478628670499366
         Q(3)=0.;                 T(3)=0.568888888888889
         Q(4)=+0.538469310105683; T(4)=0.478628670499366
         Q(5)=+0.906179845938664; T(5)=0.236926885056189
         MZ=3
         R(1)= 0.072994024073150; U(1)=0.157136361064887
         R(2)= 0.347003766038352; U(2)=0.146246269259866
         R(3)= 0.705002209888498; U(3)=0.029950703008581
         
      ELSEIF(NGAUSS.EQ.100) THEN  ! 25X4
         MX=5
         P(1)=-0.906179845938664; S(1)=0.236926885056189
         P(2)=-0.538469310105683; S(2)=0.478628670499366
         P(3)=0.;                 S(3)=0.568888888888889
         P(4)=+0.538469310105683; S(4)=0.478628670499366
         P(5)=+0.906179845938664; S(5)=0.236926885056189
         MY=5
         Q(1)=-0.906179845938664; T(1)=0.236926885056189
         Q(2)=-0.538469310105683; T(2)=0.478628670499366
         Q(3)=0.;                 T(3)=0.568888888888889
         Q(4)=+0.538469310105683; T(4)=0.478628670499366
         Q(5)=+0.906179845938664; T(5)=0.236926885056189
         MZ=4
         R(1)= 0.048500549446997; U(1)=0.110888415611278
         R(2)= 0.238600737551862; U(2)=0.143458789799214
         R(3)= 0.517047295104368; U(3)=0.068633887172923
         R(4)= 0.795851417896773; U(4)=0.010352240749918
         
      ELSEIF(NGAUSS.EQ.125) THEN  ! 25X5
         MX=5
         P(1)=-0.906179845938664; S(1)=0.236926885056189
         P(2)=-0.538469310105683; S(2)=0.478628670499366
         P(3)=0.;                 S(3)=0.568888888888889
         P(4)=+0.538469310105683; S(4)=0.478628670499366
         P(5)=+0.906179845938664; S(5)=0.236926885056189
         MY=5
         Q(1)=-0.906179845938664; T(1)=0.236926885056189
         Q(2)=-0.538469310105683; T(2)=0.478628670499366
         Q(3)=0.;                 T(3)=0.568888888888889
         Q(4)=+0.538469310105683; T(4)=0.478628670499366
         Q(5)=+0.906179845938664; T(5)=0.236926885056189
         MZ=5
         R(1)= 0.034578939918215; U(1)=0.081764784285771
         R(2)= 0.173480320771695; U(2)=0.126198961899911
         R(3)= 0.389886387065519; U(3)=0.089200161221590
         R(4)= 0.634333472630887; U(4)=0.032055600722962
         R(5)= 0.851054212947016; U(5)=0.004113825203099
         
      ELSE
         WRITE(IUT0,*) "[ERROR]@SETUP_PYR:"
         WRITE(IUT0,*) "NGAUSS=", NGAUSS, "IS NOT SUPPORTED."
         IERR=1 
         RETURN
      ENDIF
      
***********************
***** SETUP XI, W *****
***********************
      IP=1
      DO K=1,MZ
         DO J=1,MY
            DO I=1,MX
               XI(1,IP)=P(I)*(1.-R(K))
               XI(2,IP)=Q(J)*(1.-R(K))
               XI(3,IP)=R(K)
               W(IP)=S(I)*T(J)*U(K)
               IP=IP+1
            ENDDO
         ENDDO
      ENDDO
      
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

******************
***** N, PSI *****
******************
      DO IP=1,NGAUSS

      NN(1,IP) =0.25*( (1.-XI(1,IP))*(1.-XI(2,IP))
     $     -XI(3,IP) +XI(1,IP)*XI(2,IP)*XI(3,IP)/(1.-XI(3,IP)) )
      NN(2,IP) =0.25*( (1.+XI(1,IP))*(1.-XI(2,IP))
     $     -XI(3,IP) -XI(1,IP)*XI(2,IP)*XI(3,IP)/(1.-XI(3,IP)) )
      NN(3,IP) =0.25*( (1.+XI(1,IP))*(1.+XI(2,IP))
     $     -XI(3,IP) +XI(1,IP)*XI(2,IP)*XI(3,IP)/(1.-XI(3,IP)) )
      NN(4,IP) =0.25*( (1.-XI(1,IP))*(1.+XI(2,IP))
     $     -XI(3,IP) -XI(1,IP)*XI(2,IP)*XI(3,IP)/(1.-XI(3,IP)) )
      NN(5,IP) = XI(3,IP)

      PSI(1,1,IP)=0.25*( -1. +XI(2,IP)/(1.-XI(3,IP)) )
      PSI(1,2,IP)=0.25*( +1. -XI(2,IP)/(1.-XI(3,IP)) )
      PSI(1,3,IP)=0.25*( +1. +XI(2,IP)/(1.-XI(3,IP)) )
      PSI(1,4,IP)=0.25*( -1. -XI(2,IP)/(1.-XI(3,IP)) )
      PSI(1,5,IP)=0.
      
      PSI(2,1,IP)=0.25*( -1. +XI(1,IP)/(1.-XI(3,IP)) )
      PSI(2,2,IP)=0.25*( -1. -XI(1,IP)/(1.-XI(3,IP)) )
      PSI(2,3,IP)=0.25*( +1. +XI(1,IP)/(1.-XI(3,IP)) )
      PSI(2,4,IP)=0.25*( +1. -XI(1,IP)/(1.-XI(3,IP)) )
      PSI(2,5,IP)=0.
      
      PSI(3,1,IP)=0.25*( -1. +XI(1,IP)*XI(2,IP)/(1.-XI(3,IP))**2 )
      PSI(3,2,IP)=0.25*( -1. -XI(1,IP)*XI(2,IP)/(1.-XI(3,IP))**2 )
      PSI(3,3,IP)=0.25*( -1. +XI(1,IP)*XI(2,IP)/(1.-XI(3,IP))**2 )
      PSI(3,4,IP)=0.25*( -1. -XI(1,IP)*XI(2,IP)/(1.-XI(3,IP))**2 )
      PSI(3,5,IP)=1.
      ENDDO
      
      RETURN
      END
