      SUBROUTINE SETWED(N1,NGAUSS,NC,PSIC,NN,PSI,W,IUT0,IERR)
      IMPLICIT NONE
      
***** PARAMETERS *****
      INTEGER N1
      
***** DEFINE ARGUMENTS *****
      INTEGER NGAUSS
      REAL*8 NN(N1,NGAUSS)
      REAL*8 PSI(3,N1,NGAUSS)
      REAL*8 W(NGAUSS)
      REAL*8 NC(N1)
      REAL*8 PSIC(3,N1)

***** OBJECTS *****
      REAL*8 XI(3,NGAUSS)         ! XI, ETA, ZETA
      REAL*8 P(99), Q(99), R(99)  ! 
      REAL*8 S(99), U(99)         ! 
      INTEGER IUT0,IERR      
      INTEGER I, K, MXY, MZ     !
      INTEGER IP

****************************
***** N, PSI AT CENTER *****
****************************
      XI(1,1)=1./3.; XI(2,1)=1./3.; XI(3,1)=0.
      NC(1)=0.5*XI(1,1)             *(1.-XI(3,1))
      NC(2)=0.5*XI(2,1)             *(1.-XI(3,1))
      NC(3)=0.5*(1.-XI(1,1)-XI(2,1))*(1.-XI(3,1))
      NC(4)=0.5*XI(1,1)             *(1.+XI(3,1))
      NC(5)=0.5*XI(2,1)             *(1.+XI(3,1))
      NC(6)=0.5*(1.-XI(1,1)-XI(2,1))*(1.+XI(3,1))
C
      PSIC(1,1)=+0.5*(1.-XI(3,1))
      PSIC(1,2)=0.
      PSIC(1,3)=-0.5*(1.-XI(3,1))
      PSIC(1,4)=+0.5*(1.+XI(3,1))
      PSIC(1,5)=0.
      PSIC(1,6)=-0.5*(1.+XI(3,1))
      
      PSIC(2,1)=0.
      PSIC(2,2)=+0.5*(1.-XI(3,1))
      PSIC(2,3)=-0.5*(1.-XI(3,1))
      PSIC(2,4)=0.
      PSIC(2,5)=+0.5*(1.+XI(3,1))
      PSIC(2,6)=-0.5*(1.+XI(3,1))
      
      PSIC(3,1)=-0.5*XI(1,1)
      PSIC(3,2)=-0.5*XI(2,1)
      PSIC(3,3)=-0.5*(1.-XI(1,1)-XI(2,1))
      PSIC(3,4)=+0.5*XI(1,1)
      PSIC(3,5)=+0.5*XI(2,1)
      PSIC(3,6)=+0.5*(1.-XI(1,1)-XI(2,1))

      
      IF(NGAUSS.EQ.2) THEN        !1X2
         MXY=1
         P(1)=1./3.; Q(1)=1./3.;  S(1)=1./2.
         MZ=2
         R(1)=-SQRT(1./3.);       U(1)=1.
         R(2)=+SQRT(1./3.);       U(2)=1.
         
      ELSEIF(NGAUSS.EQ.3) THEN    !1X3
         MXY=1
         P(1)=1./3.; Q(1)=1./3.;  S(1)=1./2.
         MZ=3
         R(1)=-SQRT(3./5.);       U(1)=5./9.
         R(2)=0.;                 U(2)=8./9.
         R(3)=+SQRT(3./5.);       U(3)=5./9.
         
      ELSEIF(NGAUSS.EQ.9) THEN    !3X3
         MXY=3
         P(1)=4./6.; Q(1)=1./6.;  S(1)=1./6.
         P(2)=1./6.; Q(2)=4./6.;  S(2)=1./6.
         P(3)=1./6.; Q(3)=1./6.;  S(3)=1./6.
         MZ=3
         R(1)=-SQRT(3./5.);       U(1)=5./9.
         R(2)=0.;                 U(2)=8./9.
         R(3)=+SQRT(3./5.);       U(3)=5./9.
         
      ELSEIF(NGAUSS.EQ.12) THEN   !3X4
         MXY=3
         P(1)=4./6.; Q(1)=1./6.;  S(1)=1./6.
         P(2)=1./6.; Q(2)=4./6.;  S(2)=1./6.
         P(3)=1./6.; Q(3)=1./6.;  S(3)=1./6.
         MZ=4
         R(1)=-0.861136311594053; U(1)=0.347854845137454
         R(2)=-0.339981043584856; U(2)=0.652145154862546
         R(3)=+0.339981043584856; U(3)=0.652145154862546
         R(4)=+0.861136311594053; U(4)=0.347854845137454
         
      ELSEIF(NGAUSS.EQ.16) THEN   !4X4
         MXY=4
         P(1)= 1./3. ; Q(1)= 1./3. ; S(1)=-27./96.
         P(2)=11./15.; Q(2)= 2./15.; S(2)=+25./96.
         P(3)= 2./15.; Q(3)=11./15.; S(3)=+25./96.
         P(4)= 2./15.; Q(4)= 2./15.; S(4)=+25./96.
         MZ=4
         R(1)=-0.861136311594053; U(1)=0.347854845137454
         R(2)=-0.339981043584856; U(2)=0.652145154862546
         R(3)=+0.339981043584856; U(3)=0.652145154862546
         R(4)=+0.861136311594053; U(4)=0.347854845137454
         
      ELSEIF(NGAUSS.EQ.20) THEN   !4X5
         MXY=4
         P(1)= 1./3. ; Q(1)= 1./3. ; S(1)=-27./96.
         P(2)=11./15.; Q(2)= 2./15.; S(2)=+25./96.
         P(3)= 2./15.; Q(3)=11./15.; S(3)=+25./96.
         P(4)= 2./15.; Q(4)= 2./15.; S(4)=+25./96.
         MZ=5
         R(1)=-0.906179845938664; U(1)=0.236926885056189
         R(2)=-0.538469310105683; U(2)=0.478628670499366
         R(3)=0.;                 U(3)=0.568888888888889
         R(4)=+0.538469310105683; U(4)=0.478628670499366
         R(5)=+0.906179845938664; U(5)=0.236926885056189
         
      ELSEIF(NGAUSS.EQ.30) THEN   !6X5
         MXY=6
         P(1)=.108103018168070;Q(1)=.445948490915965;
         S(1)=.111690794839005
         P(2)=.445948490915965;Q(2)=.108103018168070;
         S(2)=.111690794839005
         P(3)=.445948490915965;Q(3)=.445948490915965;
         S(3)=.111690794839005
         P(4)=.816847572980458;Q(4)=.091576213509771;
         S(4)=.054975871827661
         P(5)=.091576213509771;Q(5)=.816847572980458;
         S(5)=.054975871827661
         P(6)=.091576213509771;Q(6)=.091576213509771;
         S(6)=.054975871827661
         MZ=5
         R(1)=-0.906179845938664; U(1)=0.236926885056189
         R(2)=-0.538469310105683; U(2)=0.478628670499366
         R(3)=0.;                 U(3)=0.568888888888889
         R(4)=+0.538469310105683; U(4)=0.478628670499366
         R(5)=+0.906179845938664; U(5)=0.236926885056189
         
      ELSEIF(NGAUSS.EQ.36) THEN   !6X6
         MXY=6
         P(1)=.108103018168070;Q(1)=.445948490915965;
         S(1)=.111690794839005
         P(2)=.445948490915965;Q(2)=.108103018168070;
         S(2)=.111690794839005
         P(3)=.445948490915965;Q(3)=.445948490915965;
         S(3)=.111690794839005
         P(4)=.816847572980458;Q(4)=.091576213509771;
         S(4)=.054975871827661
         P(5)=.091576213509771;Q(5)=.816847572980458;
         S(5)=.054975871827661
         P(6)=.091576213509771;Q(6)=.091576213509771;
         S(6)=.054975871827661
         MZ=6
         R(1)=-0.932469614203152; U(1)=0.171324492379170
         R(2)=-0.661209386466265; U(2)=0.360761573048139
         R(3)=-0.238619186083197; U(3)=0.467913934572691
         R(4)=+0.238619186083197; U(4)=0.467913934572691
         R(5)=+0.661209386466265; U(5)=0.360761573048139
         R(6)=+0.932469614203152; U(6)=0.171324492379170
         
      ELSEIF(NGAUSS.EQ.42) THEN   !7X6
         MXY=7
         P(1)=.333333333333333;Q(1)=.333333333333333;
         S(1)=.112500000000000
         P(2)=.059715871789770;Q(2)=.470142064105115;
         S(2)=.066197076394253
         P(3)=.470142064105115;Q(3)=.059715871789770;
         S(3)=.066197076394253
         P(4)=.470142064105115;Q(4)=.470142064105115;
         S(4)=.066197076394253
         P(5)=.797426985353088;Q(5)=.101286507323456;
         S(5)=.062969590272413
         P(6)=.101286507323456;Q(6)=.797426985353088;
         S(6)=.062969590272413
         P(7)=.101286507323456;Q(7)=.101286507323456;
         S(7)=.062969590272413
         MZ=6
         R(1)=-0.932469614203152; U(1)=0.171324492379170
         R(2)=-0.661209386466265; U(2)=0.360761573048139
         R(3)=-0.238619186083197; U(3)=0.467913934572691
         R(4)=+0.238619186083197; U(4)=0.467913934572691
         R(5)=+0.661209386466265; U(5)=0.360761573048139
         R(6)=+0.932469614203152; U(6)=0.171324492379170
         
      ELSEIF(NGAUSS.EQ.49) THEN   !7X7
         MXY=7
         P(1)=.333333333333333;Q(1)=.333333333333333;
         S(1)=.112500000000000
         P(2)=.059715871789770;Q(2)=.470142064105115;
         S(2)=.066197076394253
         P(3)=.470142064105115;Q(3)=.059715871789770;
         S(3)=.066197076394253
         P(4)=.470142064105115;Q(4)=.470142064105115;
         S(4)=.066197076394253
         P(5)=.797426985353088;Q(5)=.101286507323456;
         S(5)=.062969590272413
         P(6)=.101286507323456;Q(6)=.797426985353088;
         S(6)=.062969590272413
         P(7)=.101286507323456;Q(7)=.101286507323456;
         S(7)=.062969590272413
         MZ=7
         R(1)=-0.949107912342758; U(1)=0.129484966168870
         R(2)=-0.741531185599394; U(2)=0.279705391489277
         R(3)=-0.405845151377397; U(3)=0.381830050505119
         R(4)=0.;                 U(4)=0.417959183673469
         R(5)=+0.405845151377397; U(5)=0.381830050505119
         R(6)=+0.741531185599394; U(6)=0.279705391489277
         R(7)=+0.949107912342758; U(7)=0.129484966168870
         
      ELSEIF(NGAUSS.EQ.91) THEN   !13X7
         MXY=13
         P( 1)=.3333333333333;Q( 1)=.3333333333333;
         S( 1)=-.0747850222335
         P( 2)=.0651301029002;Q( 2)=.0651301029002;
         S( 2)=.02667361780040
         P( 3)=.8697397941956;Q( 3)=.0651301029002;
         S( 3)=.02667361780040
         P( 4)=.0651301029002;Q( 4)=.8697397941956;
         S( 4)=.02667361780040
         P( 5)=.3128654960049;Q( 5)=.0486903154253;
         S( 5)=.03855688044515
         P( 6)=.6384441885698;Q( 6)=.3128654960049;
         S( 6)=.03855688044515
         P( 7)=.0486903154253;Q( 7)=.6384441885698;
         S( 7)=.03855688044515
         P( 8)=.6384441885698;Q( 8)=.0486903154253;
         S( 8)=.03855688044515
         P( 9)=.3128654960049;Q( 9)=.6384441885698;
         S( 9)=.03855688044515
         P(10)=.0486903154253;Q(10)=.3128654960049;
         S(10)=.03855688044515
         P(11)=.2603459660790;Q(11)=.2603459660790;
         S(11)=.08780762871660
         P(12)=.4793080678419;Q(12)=.2603459660790;
         S(12)=.08780762871660
         P(13)=.2603459660790;Q(13)=.4793080678419;
         S(13)=.08780762871660
         MZ=7
         R(1)=-0.949107912342758; U(1)=0.129484966168870
         R(2)=-0.741531185599394; U(2)=0.279705391489277
         R(3)=-0.405845151377397; U(3)=0.381830050505119
         R(4)=0.;                 U(4)=0.417959183673469
         R(5)=+0.405845151377397; U(5)=0.381830050505119
         R(6)=+0.741531185599394; U(6)=0.279705391489277
         R(7)=+0.949107912342758; U(7)=0.129484966168870
         
      ELSE
         WRITE(IUT0,*) "[ERROR]@SETUP_WED:"
         WRITE(IUT0,*) "NGAUSS=", NGAUSS, "IS NOT SUPPORTED."
         IERR=1
         RETURN
      ENDIF
      
***********************
***** SETUP XI, W *****
***********************
      IP=1
      DO K=1,MZ
         DO I=1,MXY
            XI(1,IP)=P(I)
            XI(2,IP)=Q(I)
            XI(3,IP)=R(K)
            W(IP)=S(I)*U(K)
            IP=IP+1
         ENDDO
      ENDDO

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC

******************
***** N, PSI *****
******************
      DO IP=1,NGAUSS
      NN(1,IP)=0.5*XI(1,IP)             *(1.-XI(3,IP))
      NN(2,IP)=0.5*XI(2,IP)             *(1.-XI(3,IP))
      NN(3,IP)=0.5*(1.-XI(1,IP)-XI(2,IP))*(1.-XI(3,IP))
      NN(4,IP)=0.5*XI(1,IP)             *(1.+XI(3,IP))
      NN(5,IP)=0.5*XI(2,IP)             *(1.+XI(3,IP))
      NN(6,IP)=0.5*(1.-XI(1,IP)-XI(2,IP))*(1.+XI(3,IP))
C
      PSI(1,1,IP)=+0.5*(1.-XI(3,IP))
      PSI(1,2,IP)=0.
      PSI(1,3,IP)=-0.5*(1.-XI(3,IP))
      PSI(1,4,IP)=+0.5*(1.+XI(3,IP))
      PSI(1,5,IP)=0.
      PSI(1,6,IP)=-0.5*(1.+XI(3,IP))
      
      PSI(2,1,IP)=0.
      PSI(2,2,IP)=+0.5*(1.-XI(3,IP))
      PSI(2,3,IP)=-0.5*(1.-XI(3,IP))
      PSI(2,4,IP)=0.
      PSI(2,5,IP)=+0.5*(1.+XI(3,IP))
      PSI(2,6,IP)=-0.5*(1.+XI(3,IP))
      
      PSI(3,1,IP)=-0.5*XI(1,IP)
      PSI(3,2,IP)=-0.5*XI(2,IP)
      PSI(3,3,IP)=-0.5*(1.-XI(1,IP)-XI(2,IP))
      PSI(3,4,IP)=+0.5*XI(1,IP)
      PSI(3,5,IP)=+0.5*XI(2,IP)
      PSI(3,6,IP)=+0.5*(1.-XI(1,IP)-XI(2,IP))
      ENDDO

      RETURN
      END
